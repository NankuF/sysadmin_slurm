# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ 2FA –¥–ª—è –ª–∏–Ω—É–∫—Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ SSH
```bash
sudo apt update
sudo apt install -y libpam-google-authenticator
google-authenticator
```
–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã:

- Time-based tokens? ‚Üí y
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ QR-–∫–æ–¥ –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–¥—ã !!!! –ß—Ç–æ–±—ã –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –µ—Å–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –±—É–¥–µ—Ç —É—Ç–µ—Ä—è–Ω
- y ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª
- y ‚Äî –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- n ‚Äî "window" ¬±30 —Å–µ–∫
- y ‚Äî rate-limiting (3 –ø–æ–ø—ã—Ç–∫–∏ –∑–∞ 30 —Å–µ–∫)

```text
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ google-authenticator –≤–∞–º –≤—ã–¥–∞—é—Ç—Å—è 5 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–¥–æ–≤ (emergency scratch codes).

üîπ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Ö –≤ –Ω–∞–¥—ë–∂–Ω–æ–µ –º–µ—Å—Ç–æ:
- –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π (Bitwarden, 1Password, KeePass)
- –ü–µ—á–∞—Ç—å –Ω–∞ –±—É–º–∞–≥–µ ‚Üí —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ–π—Ñ–µ
- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
```


```bash
sudo nano /etc/pam.d/sshd
#@include common-auth
auth required pam_google_authenticator.so
```
```bash
sudo nano /etc/ssh/sshd_config
PasswordAuthentication no
PubkeyAuthentication yes   #–º–æ–∂–Ω–æ –Ω–µ –≤–∫–ª—é—á–∞—Ç—å, —Ç–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ
KbdInteractiveAuthentication yes
AuthenticationMethods publickey,keyboard-interactive:pam
```
```bash
sudo systemctl restart ssh
```
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ –æ—Ç–∫–ª—é—á–∞—è—Å—å –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ, —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª